System.register(["jimu-core","jimu-ui/advanced/setting-components","jimu-ui/advanced/data-source-selector","jimu-ui","jimu-ui/advanced/style-setting-components","jimu-ui/basic/date-picker","jimu-core/react","jimu-core/dnd","jimu-arcgis","jimu-ui/basic/color-picker"],(function(e,t){var a={},s={},i={},n={},o={},l={},r={},c={},u={},p={};return{setters:[function(e){a.AllDataSourceTypes=e.AllDataSourceTypes,a.DataSourceComponent=e.DataSourceComponent,a.DataSourceManager=e.DataSourceManager,a.DataSourceTypes=e.DataSourceTypes,a.Immutable=e.Immutable,a.React=e.React,a.ReactRedux=e.ReactRedux,a.TimezoneConfig=e.TimezoneConfig,a.classNames=e.classNames,a.css=e.css,a.dataSourceUtils=e.dataSourceUtils,a.dateUtils=e.dateUtils,a.getAppStore=e.getAppStore,a.hooks=e.hooks,a.jsx=e.jsx,a.lodash=e.lodash,a.polished=e.polished},function(e){s.SettingRow=e.SettingRow,s.SettingSection=e.SettingSection,s.SidePopper=e.SidePopper},function(e){i.DataSourceSelector=e.DataSourceSelector},function(e){n.Alert=e.Alert,n.Button=e.Button,n.Checkbox=e.Checkbox,n.Icon=e.Icon,n.Label=e.Label,n.NumericInput=e.NumericInput,n.Option=e.Option,n.Radio=e.Radio,n.Select=e.Select,n.Switch=e.Switch,n.Tooltip=e.Tooltip,n.defaultMessages=e.defaultMessages},function(e){o.DateUnitInput=e.DateUnitInput},function(e){l.DatePicker=e.DatePicker},function(e){r.default=e.default},function(e){c.interact=e.interact},function(e){u.ArcGISDataSourceTypes=e.ArcGISDataSourceTypes},function(e){p.ThemeColorPicker=e.ThemeColorPicker}],execute:function(){e((()=>{var e={15656:(e,t,a)=>{var s={"./style_classic.svg":50816,"./style_modern.svg":26805};function i(e){var t=n(e);return a(t)}function n(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=n,e.exports=i,i.id=15656},43673:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M4.182 9.727a1.91 1.91 0 1 0 0-3.818 1.91 1.91 0 0 0 0 3.818M7.3 7.182a3.183 3.183 0 1 0 0 1.273h1.4a3.183 3.183 0 1 0 0-1.273z" clip-rule="evenodd"></path></svg>'},72823:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 1C4.15 1 1 4.15 1 8s3.15 7 7 7 7-3.15 7-7-3.15-7-7-7m1.167 11.667H6.834v-2.334h2.333zm-2.333-4.5V3.333h2.333v4.834z" clip-rule="evenodd"></path></svg>'},31027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},80914:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="m8 0 8 6-8 6-8-6zM1.887 6 8 10.82 14.113 6 8 1.18zM0 9.81.563 9 8 14.775 15.437 9l.563.81L8 16z" clip-rule="evenodd"></path></svg>'},45508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},50816:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA0IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA0IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04OCAyMkM4OCAyMC44OTU0IDg4Ljg5NTQgMjAgOTAgMjBIOTRDOTUuMTA0NiAyMCA5NiAyMC44OTU0IDk2IDIyQzk2IDIzLjEwNDYgOTUuMTA0NiAyNCA5NCAyNEg5MEM4OC44OTU0IDI0IDg4IDIzLjEwNDYgODggMjJaTTggMjFIMjJWMjNIOFYyMVpNOTQgNDZDOTIuODk1NCA0NiA5MiA0Ni44OTU0IDkyIDQ4QzkyIDQ5LjEwNDYgOTIuODk1NCA1MCA5NCA1MEM5NS4xMDQ2IDUwIDk2IDQ5LjEwNDYgOTYgNDhDOTYgNDYuODk1NCA5NS4xMDQ2IDQ2IDk0IDQ2Wk00NSA0NkM0My44OTU0IDQ2IDQzIDQ2Ljg5NTQgNDMgNDhDNDMgNDkuMTA0NiA0My44OTU0IDUwIDQ1IDUwQzQ2LjEwNDYgNTAgNDcgNDkuMTA0NiA0NyA0OEM0NyA0Ni44OTU0IDQ2LjEwNDYgNDYgNDUgNDZaTTQ5IDQ4QzQ5IDQ2Ljg5NTQgNDkuODk1NCA0NiA1MSA0NkM1Mi4xMDQ2IDQ2IDUzIDQ2Ljg5NTQgNTMgNDhDNTMgNDkuMTA0NiA1Mi4xMDQ2IDUwIDUxIDUwQzQ5Ljg5NTQgNTAgNDkgNDkuMTA0NiA0OSA0OFpNNTUgNDhDNTUgNDYuODk1NCA1NS44OTU0IDQ2IDU3IDQ2QzU4LjEwNDYgNDYgNTkgNDYuODk1NCA1OSA0OEM1OSA0OS4xMDQ2IDU4LjEwNDYgNTAgNTcgNTBDNTUuODk1NCA1MCA1NSA0OS4xMDQ2IDU1IDQ4Wk0xMCA0NkM4Ljg5NTQzIDQ2IDggNDYuODk1NCA4IDQ4QzggNDkuMTA0NiA4Ljg5NTQzIDUwIDEwIDUwQzExLjEwNDYgNTAgMTIgNDkuMTA0NiAxMiA0OEMxMiA0Ni44OTU0IDExLjEwNDYgNDYgMTAgNDZaTTkgMzBIMTBWMzRIOVYzMFpNMjMgMzJIMjRWMzRIMjNWMzJaTTM4IDMwSDM3VjM0SDM4VjMwWk01MSAzMkg1MlYzNEg1MVYzMlpNNjYgMzBINjVWMzRINjZWMzBaTTc5IDMySDgwVjM0SDc5VjMyWk05NCAzMEg5M1YzNEg5NFYzMFpNMTAuNSAzNkg5My41Qzk0Ljg4MDcgMzYgOTYgMzcuMTE5MyA5NiAzOC41Qzk2IDM5Ljg4MDcgOTQuODgwNyA0MSA5My41IDQxSDEwLjVDOS4xMTkyOSA0MSA4IDM5Ljg4MDcgOCAzOC41QzggMzcuMTE5MyA5LjExOTI5IDM2IDEwLjUgMzZaTTEwLjUgMzdDOS42NzE1NyAzNyA5IDM3LjY3MTYgOSAzOC41QzkgMzkuMzI4NCA5LjY3MTU3IDQwIDEwLjUgNDBIMjIuNDk4M0MyMS42Njk5IDQwIDIwLjk5ODMgMzkuMzI4NCAyMC45OTgzIDM4LjVDMjAuOTk4MyAzNy42NzE2IDIxLjY2OTkgMzcgMjIuNDk4MyAzN0gxMC41Wk05My41IDQwSDMxLjQ5NjlDMzIuMzI1MyA0MCAzMi45OTY5IDM5LjMyODQgMzIuOTk2OSAzOC41QzMyLjk5NjkgMzcuNjcxNiAzMi4zMjUzIDM3IDMxLjQ5NjkgMzdIOTMuNUM5NC4zMjg0IDM3IDk1IDM3LjY3MTYgOTUgMzguNUM5NSAzOS4zMjg0IDk0LjMyODQgNDAgOTMuNSA0MFoiIGZpbGw9IiM2QTZBNkEiLz4NCjwvc3ZnPg0K"},26805:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA0IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA0IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04MiAyMEM4MC44OTU0IDIwIDgwIDIwLjg5NTQgODAgMjJDODAgMjMuMTA0NiA4MC44OTU0IDI0IDgyIDI0SDg3Qzg4LjEwNDYgMjQgODkgMjMuMTA0NiA4OSAyMkM4OSAyMC44OTU0IDg4LjEwNDYgMjAgODcgMjBIODJaTTE4IDI3SDg2Qzg3LjY1NjkgMjcgODkgMjguMzQzMSA4OSAzMFY0NkM4OSA0Ny42NTY5IDg3LjY1NjkgNDkgODYgNDlIODNWNDZIODJWNDlINzNWNDFINzJWNDlINjNWNDZINjJWNDlINTNWNDFINTJWNDlINDNWNDhINDJWNDlIMzNWNDFIMzJWNDlIMjNWNDZIMjJWNDlIMThDMTYuMzQzMSA0OSAxNSA0Ny42NTY5IDE1IDQ2VjMwQzE1IDI4LjM0MzEgMTYuMzQzMSAyNyAxOCAyN1pNMTQgMzBDMTQgMjcuNzkwOSAxNS43OTA5IDI2IDE4IDI2SDg2Qzg4LjIwOTEgMjYgOTAgMjcuNzkwOSA5MCAzMFY0NkM5MCA0OC4yMDkxIDg4LjIwOTEgNTAgODYgNTBIMThDMTUuNzkwOSA1MCAxNCA0OC4yMDkxIDE0IDQ2VjMwWk0zNCAzMkMzNCAzMC4zNDMxIDM1LjM0MzEgMjkgMzcgMjlINDJDNDMuNjU2OSAyOSA0NSAzMC4zNDMxIDQ1IDMyVjQ0QzQ1IDQ1LjY1NjkgNDMuNjU2OSA0NyA0MiA0N0gzN0MzNS4zNDMxIDQ3IDM0IDQ1LjY1NjkgMzQgNDRWMzJaTTggMzRDOCAzMi44OTU0IDguODk1NDMgMzIgMTAgMzJDMTEuMTA0NiAzMiAxMiAzMi44OTU0IDEyIDM0QzEyIDM1LjEwNDYgMTEuMTA0NiAzNiAxMCAzNkM4Ljg5NTQzIDM2IDggMzUuMTA0NiA4IDM0Wk04IDQyQzggNDAuODk1NCA4Ljg5NTQzIDQwIDEwIDQwQzExLjEwNDYgNDAgMTIgNDAuODk1NCAxMiA0MkMxMiA0My4xMDQ2IDExLjEwNDYgNDQgMTAgNDRDOC44OTU0MyA0NCA4IDQzLjEwNDYgOCA0MlpNOTQgMzJDOTIuODk1NCAzMiA5MiAzMi44OTU0IDkyIDM0QzkyIDM1LjEwNDYgOTIuODk1NCAzNiA5NCAzNkM5NS4xMDQ2IDM2IDk2IDM1LjEwNDYgOTYgMzRDOTYgMzIuODk1NCA5NS4xMDQ2IDMyIDk0IDMyWk05NCA0MEM5Mi44OTU0IDQwIDkyIDQwLjg5NTQgOTIgNDJDOTIgNDMuMTA0NiA5Mi44OTU0IDQ0IDk0IDQ0Qzk1LjEwNDYgNDQgOTYgNDMuMTA0NiA5NiA0MkM5NiA0MC44OTU0IDk1LjEwNDYgNDAgOTQgNDBaTTE0IDIyQzE0IDIwLjg5NTQgMTQuODk1NCAyMCAxNiAyMEMxNy4xMDQ2IDIwIDE4IDIwLjg5NTQgMTggMjJDMTggMjMuMTA0NiAxNy4xMDQ2IDI0IDE2IDI0QzE0Ljg5NTQgMjQgMTQgMjMuMTA0NiAxNCAyMlpNNjAgMjFINDZWMjNINjBWMjFaIiBmaWxsPSIjNkE2QTZBIi8+DQo8L3N2Zz4NCg=="},62686:e=>{"use strict";e.exports=u},79244:e=>{"use strict";e.exports=a},26245:e=>{"use strict";e.exports=c},68972:e=>{"use strict";e.exports=r},14321:e=>{"use strict";e.exports=n},13089:e=>{"use strict";e.exports=i},79298:e=>{"use strict";e.exports=s},15562:e=>{"use strict";e.exports=o},54337:e=>{"use strict";e.exports=p},25938:e=>{"use strict";e.exports=l}},t={};function g(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,g),i.exports}g.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return g.d(t,{a:t}),t},g.d=(e,t)=>{for(var a in t)g.o(t,a)&&!g.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},g.p="";var d={};return g.p=window.jimuConfig.baseUrl,(()=>{"use strict";g.r(d),g.d(d,{__set_webpack_public_path__:()=>Me,default:()=>Se});var e,t,a,s=g(79244),i=g(79298),n=g(13089),o=g(14321);!function(e){e.Classic="CLASSIC",e.Modern="MODERN"}(e||(e={})),function(e){e.Slowest="SLOWEST",e.Slow="SLOW",e.Medium="MEDIUM",e.Fast="FAST",e.Fastest="FASTEST"}(t||(t={})),function(e){e.current="CURRENT",e.cumulatively="CUMULATIVE"}(a||(a={}));function l(e){return s.css`
    height: calc(100% - ${s.polished.rem(50)});
    overflow: auto;

    .date-label {
      color: ${e.ref.palette.neutral[1e3]};
    }
    .time-step-details {
      margin-top: 0.75rem !important;
    }
  `}function r(e){return s.css`
    &.show-disabled-mask {
      position: relative;
      overflow-y: hidden;
      .disabled-mask {
        position: absolute;
        top: 0;
        background-color: transparent;
        .mask-bg {
          width: 100%;
          height: 100%;
          background-color: #000;
          opacity: 0.5;
        }
        .alert-container {
          position: absolute;
          left: 10px;
          top: 16px;
        }
      }
    }

    .style-container{
      display: flex;
      justify-content: space-between;
      .jimu-btn {
        padding: 0;
        background: ${e.ref.palette.neutral[300]};
        &.active{
          background: ${e.ref.palette.neutral[300]};
          outline: 2px solid ${e.sys.color.primary.main};
        }
      }
    }
    .autoplay-label{
      color: ${e.ref.palette.neutral[900]};
    }

    .empty-placeholder {
      display: flex;
      flex-flow: column;
      justify-content: center;
      height: calc(100% - 165px);
      overflow: hidden;
      .empty-placeholder-inner {
        padding: 0px 20px;
        flex-direction: column;
        align-items: center;
        display: flex;

        .empty-placeholder-text {
          color: ${e.ref.palette.neutral[1e3]};
          font-size: ${s.polished.rem(14)};
          margin-top: 16px;
          text-align: center;
        }
        .empty-placeholder-icon {
          color: ${e.ref.palette.neutral[800]};
        }
      }
    }

    .honor-label {
      color: ${e.ref.palette.neutral[1100]};
    }
  `}function c(e){return s.css`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: ${e}px;
  `}var u=g(15562),p=g(25938),m=g(68972),h=g(26245),D=g(62686);const y=["year","month","day"],S=["hour","minute","second"],M=10,f=-59011488343e3,T=325036512e5,N="d/M/y",x="h:mm:ss a";var j;!function(e){e[e.year=31536e3]="year",e[e.month=2592e3]="month",e[e.day=86400]="day",e[e.hour=3600]="hour",e[e.minute=60]="minute",e[e.second=1]="second"}(j||(j={}));const v={slowest:5e3,slow:4e3,medium:3e3,fast:2e3,fastest:1e3};function I(e){let a;const s=1e3*Math.ceil(e/1e3);return Object.keys(v).some((e=>v[e]===s&&(a=e.toUpperCase(),!0))),a||(s>v.slowest?a=t.Slowest:s<v.fastest&&(a=t.Fastest)),a}function w(e,a,i=!1){const{startTime:n,endTime:o,layerList:l,accuracy:r,stepLength:c}=e||{};let u;const{startTime:p,endTime:g}=function(e,t,a,s){let i=O(a),n=O(s,!1),o=null,l=null;if(!i||!n){const a=A(e,t);a&&(e=a);if(Object.keys(e).filter((t=>null===e[t])).length===Object.keys(e).length)return{startTime:i,endTime:n};Object.keys(e).forEach((t=>{var a,s;const r=e[t];if(!r)return;const c=r.getTimeInfo();if(!i){const e=null===(a=null==c?void 0:c.timeExtent)||void 0===a?void 0:a[0];o=o?Math.min(o,e):e}if(!n){const e=null===(s=null==c?void 0:c.timeExtent)||void 0===s?void 0:s[1];l=l?Math.max(l,e):e}})),i=i||o,n=n||l}return k(i,n,!0)}(a,l,n,o);if(!p||!g)return null;const d=z(p,g),m=d[0],h=b(p,g,m);if(e){u=(0,s.Immutable)(e);const t=!d.includes(r);t&&(u=u.set("accuracy",m)),c&&(t||j[c.unit]>j[m]||1e3*j[c.unit]*c.val>g-p)&&(u=u.set("stepLength",h))}else u=(0,s.Immutable)(function(e,a){return{layerList:null,startTime:{value:s.dateUtils.VirtualDateType.Min},endTime:{value:s.dateUtils.VirtualDateType.Max},timeDisplayStrategy:"CURRENT",dividedCount:null,accuracy:e,stepLength:a,speed:t.Medium}}(m,h));return i?(u=u.set("startTime",{value:p}).set("endTime",{value:g}),u):(0,s.Immutable)({config:u,exactStartTime:p,exactEndTime:g,minAccuracy:m,accuracyList:d})}function b(e,t,a){const s=(t-e)/1e3/j[a];return{val:s>10?M:s>5?5:1,unit:a}}function O(e,t=!0){let a=null;if(e)if("number"==typeof e.value)a=e.value;else{const i=new Date;i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),e.value===s.dateUtils.VirtualDateType.Today?(i.setHours(0),a=i.getTime()+C(e),a=t?a:a+1e3*j.day):e.value===s.dateUtils.VirtualDateType.Now&&(a=i.getTime()+C(e),a=t?a:a+1e3*j.hour)}return a}function C(e){return e.offset?e.offset.val*j[e.offset.unit]*1e3:0}function A(e,t){let a=null;const i=Object.keys(e).map((t=>e[t]))[0];if((null==i?void 0:i.type)===D.ArcGISDataSourceTypes.WebMap){const e=[];i.getAllChildDataSources().forEach((t=>{((t.type===s.DataSourceTypes.MapService||t.type===s.DataSourceTypes.ImageryLayer||t.type===s.DataSourceTypes.ImageryTileLayer)&&t.supportTime()||t.type===s.DataSourceTypes.FeatureLayer&&null===s.dataSourceUtils.findMapServiceDataSource(t)&&t.supportTime())&&e.push(t)}));const n=(null==t?void 0:t.map((e=>e.dataSourceId)))||[];a={},e.forEach((e=>{(0===n.length||n.includes(e.id))&&(a[e.id]=e)}))}return a}function k(e,t,a=!1){let i;if(i=window.jimuConfig.isBuilder?(0,s.getAppStore)().getState().appStateInBuilder.appConfig.attributes.timezone:(0,s.getAppStore)().getState().appConfig.attributes.timezone,(null==i?void 0:i.type)===s.TimezoneConfig.Specific){const n=s.dataSourceUtils.getTimeZoneOffsetByName(i.value),o=s.dataSourceUtils.getLocalTimeOffset();a?(e=e-o+n,t=t-o+n):(e=e+o-n,t=t+o-n)}return{startTime:e,endTime:t}}function z(e,t){const a=[...y,...S],s=[],i=t-e;return a.forEach((e=>{i>=1e3*j[e]&&s.push(e)})),s}function L(e){return e===s.DataSourceTypes.FeatureLayer||e===s.DataSourceTypes.ImageryLayer||e===s.DataSourceTypes.ImageryTileLayer}function E(e,t,a,s){let i=0;t[0]!==a&&(i=e/((t[1]-t[0])/(a-t[0])),i<0&&(i=0));let n=e/((t[1]-t[0])/(s-a));return n<=2&&(n=2),{marginLeft:i+"px",width:n+"px"}}function Q(e,t,a,s,i,n){let o=e,l=t;const r=(a[1]-a[0])/s*i;return n.edges.left?(o=e-r,o=Math.max(f,o)):(l=t+r,l=Math.min(T,l)),{newStart:o,newEnd:l}}var U=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a};const R=[{name:"offset",options:{offset:[0,10]}}],P=function(e){const{width:t,isRTL:a,shadowHeight:i,extent:n,intl:l,onChange:r}=e,c=U(e,["width","isRTL","shadowHeight","extent","intl","onChange"]),{startValue:u,endValue:p}=c,[g,d]=s.React.useState([u,p]),[m,D]=s.React.useState(null),y=s.React.useRef(null),S=s.React.useRef(null),M=s.React.useRef(null);s.React.useEffect((()=>{const e=s.lodash.debounce((()=>{m&&m.unset(),y.current&&D(function(e,t,a,s,i,n,o,l){let r,c,u;const p=s-a;return e(t).resizable({edges:{left:".resize-left",right:".resize-right"}}).on("resizestart",(e=>{e.stopPropagation(),r=0;const a=t.getBoundingClientRect();c=a.width,u=parseFloat(t.style.marginLeft.split("px")[0]),t.style.minWidth="0px"})).on("resizemove",(e=>{e.stopPropagation();const l=e.deltaRect;r+=l.width,e.edges.left?r>0?(a<=f&&(r=u),r=Math.min(u+20,r)):r=Math.max(20-c,r):e.edges.right&&(r>0?(s>=T&&(r=n-u-c),r=Math.min(n-u-c+20,r)):r=Math.max(20-c,r));const g=p&&c+r;e.edges.left&&(t.style.marginLeft=u-r+"px"),t.style.width=g+"px";const d=Q(a,s,i,n,r,e);o([d.newStart,d.newEnd])})).on("resizeend",(e=>{e.stopPropagation();const t=Q(a,s,i,n,r,e);l(t.newStart,t.newEnd)}))}(h.interact,y.current,g[0],g[1],n,t,d,r))}),50);e()}),[n]),s.React.useEffect((()=>{function e(e){e.edges={left:!0},j(e)}function t(e){e.edges={right:!0},j(e)}return S.current.addEventListener("keyup",e,!0),M.current.addEventListener("keyup",t,!0),()=>{S.current&&M.current&&(S.current.removeEventListener("keyup",e,!0),M.current.removeEventListener("keyup",t,!0))}}),[]);const j=s.hooks.useEventCallback((e=>{if(e.key.includes("Arrow")){let a="ArrowLeft"===e.key||"ArrowTop"===e.key?5:-5;e.edges.right&&(a=-a);const s=Q(u,p,n,t,a,e);r(s.newStart,s.newEnd)}}));s.React.useEffect((()=>{d([u,p])}),[u,p]);const v=s.React.useMemo((()=>E(t,n,g[0],g[1])),[t,n,g]),I=s.React.useMemo((()=>s.dateUtils.formatDateLocally(g[0],l,N,x)),[l,g]),w=s.React.useMemo((()=>s.dateUtils.formatDateLocally(g[1],l,N,x)),[l,g]);return(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)("span",{className:"range-shadow",css:s.css`
          left: ${a?"unset":v.marginLeft};
          right: ${a?v.marginLeft:"unset"};
          width: ${v.width};
          height: ${i+"px"};
        `}),(0,s.jsx)("div",{className:"layer-line extent-line",style:{width:t}},(0,s.jsx)("div",{className:"resize-handlers",ref:e=>y.current=e,style:v},(0,s.jsx)(o.Tooltip,{placement:"bottom",modifiers:R,title:I},(0,s.jsx)("button",{className:"resize-handler resize-left",ref:e=>{S.current=e}})),(0,s.jsx)(o.Tooltip,{placement:"bottom",modifiers:R,title:w},(0,s.jsx)("button",{className:"resize-handler resize-right",ref:e=>{M.current=e}})))))};var W=g(80914),V=g.n(W),Y=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a};const F=e=>{const t=window.SVG,{className:a}=e,i=Y(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:V()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var B=g(43673),$=g.n(B),Z=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a};const J=e=>{const t=window.SVG,{className:a}=e,i=Z(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:$()},i)):s.React.createElement("svg",Object.assign({className:n},i))};function G(e){const t=(0,s.getAppStore)().getState().appContext.isRTL;return s.css`
    .layer-lines{
      position: relative;

      .range-shadow {
        margin-left: ${t?"unset":"30px"};
        margin-right: ${t?"30px":"unset"};
        position: absolute;
        top: 0;
        z-index: -1;
        background: linear-gradient(0deg, #010101 0%, rgba(1, 1, 1, 0) 100%);
      }
      .layer-line-container {
        margin-bottom: 0.25rem;
        .layer-icon {
          margin-right: ${s.polished.rem(14)};
        }
        .layer-line, .extent-line {
          height: 2px;
        }
        .layer-line {
          background: ${e.ref.palette.neutral[900]};
          .jimu-btn {
            margin-left: 1rem;
          }
        }
      }
      .extent-line {
        background: ${e.ref.palette.neutral[700]};
        .resize-handlers {
          background: ${e.sys.color.primary.light};
          height: 2px;
          display: flex;
          justify-content: space-between;
          .resize-handler {
            min-width: 10px;
            width: 10px;
            height: 10px;
            border-radius: 10px;
            overflow: visible;
            margin-top: -5px;
            padding: 0;
            border: none;
            background: ${e.ref.palette.neutral[500]};
            border: 2px solid ${e.sys.color.primary.light};
          }
        }
      }
    }
  `}const H=function(e){const{startTime:t,endTime:a,theme:i,intl:n,overalExtentLabel:l,width:r=188,dataSources:c,onChange:u}=e,[p,g]=m.default.useState(null),[d,h]=m.default.useState(null),[D,y]=m.default.useState(null),S=(0,s.getAppStore)().getState().appContext.isRTL;m.default.useEffect((()=>{d&&f()}),[t,a]),m.default.useEffect((()=>{M()}),[c]);const M=()=>{let e=null,t=null;const a=[];Object.keys(c).forEach((i=>{var o,l;const r=c[i],u=r.getTimeInfo(),p=null===(o=null==u?void 0:u.timeExtent)||void 0===o?void 0:o[0],g=null===(l=null==u?void 0:u.timeExtent)||void 0===l?void 0:l[1];a.push({label:r.getLabel(),extent:[p,g],extentLabels:[s.dateUtils.formatDateLocally(p,n,N,x),s.dateUtils.formatDateLocally(g,n,N,x)]}),e=e?Math.min(e,p):p,t=t?Math.max(t,g):g})),g(a),h([e,t]),f(e,t)},f=(e=d[0],s=d[1])=>{const i=t?Math.min(t,e):e,n=a?Math.max(a,s):s;y([i,n])};return(0,s.jsx)("div",{className:"time-span w-100",dir:"ltr",css:G(i)},(0,s.jsx)("div",{className:"layer-lines",css:s.css`
          height: ${20*(Object.keys(c).length+1)};
        `},null==p?void 0:p.map(((e,t)=>{const a=E(r,D,e.extent[0],e.extent[1]);return(0,s.jsx)("div",{className:"d-flex align-items-center layer-line-container",key:"layerline-"+t},(0,s.jsx)(o.Tooltip,{placement:"bottom",title:(0,s.jsx)("div",{className:"p-2"},(0,s.jsx)("div",null,e.label),(0,s.jsx)("div",null,`${e.extentLabels[0]}-${e.extentLabels[1]}`))},(0,s.jsx)(o.Button,{icon:!0,size:"sm",type:"tertiary",className:"layer-icon p-0 border-0"},(0,s.jsx)(F,{size:12}))),(0,s.jsx)("div",{className:"layer-line",css:s.css`
                  margin-left: ${S?"unset":a.marginLeft};
                  margin-right: ${S?a.marginLeft:"unset"};
                  width: ${a.width};
                `}))})),(0,s.jsx)("div",{className:"d-flex align-items-center layer-line-container"},(0,s.jsx)(o.Tooltip,{placement:"bottom",title:l},(0,s.jsx)(o.Button,{icon:!0,size:"sm",type:"tertiary",className:"layer-icon p-0"},(0,s.jsx)(J,{size:12}))),D&&(0,s.jsx)(P,{theme:i,width:r,isRTL:S,intl:n,shadowHeight:20*p.length+10,startValue:null!=t?t:D[0],endValue:null!=a?a:D[1],extent:D,onChange:(e,t)=>{u(e,t)}}))))};var _=g(45508),q=g.n(_),K=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a};const X=e=>{const t=window.SVG,{className:a}=e,i=K(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:q()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var ee=g(72823),te=g.n(ee),ae=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a};const se=e=>{const t=window.SVG,{className:a}=e,i=ae(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:te()},i)):s.React.createElement("svg",Object.assign({className:n},i))},ie=(0,s.Immutable)([s.AllDataSourceTypes.FeatureLayer,s.AllDataSourceTypes.MapService]),ne=[s.dateUtils.VirtualDateType.Min,s.dateUtils.VirtualDateType.Today,s.dateUtils.VirtualDateType.Now],oe=[s.dateUtils.VirtualDateType.Max,s.dateUtils.VirtualDateType.Today,s.dateUtils.VirtualDateType.Now];class le extends s.React.PureComponent{constructor(e){super(e),this.timeSpanChanged=(e,t)=>{const{config:a,dataSources:s,exactStartTime:i,exactEndTime:n}=this.props;let o;if(i!==e)o=a.set("startTime",{value:e}),this.checkIfDatesInvalid({value:e},!0);else{if(n===t)return;o=a.set("endTime",{value:t}),this.checkIfDatesInvalid({value:t},!1)}if(a.stepLength){const e=w(o,s).config;o=o.set("accuracy",e.accuracy).set("stepLength",e.stepLength)}this.props.onChange(o)},this.onTimeChanged=(e,t)=>{const{config:a,dataSources:i}=this.props,n={value:e};e===s.dateUtils.VirtualDateType.Today?n.offset={val:0,unit:"day"}:e===s.dateUtils.VirtualDateType.Now?n.offset={val:0,unit:"minute"}:"number"==typeof e&&(n.value=t?Math.max(f,e):Math.min(T,e));let o=a.set((t?"start":"end")+"Time",n);if(this.checkIfDatesInvalid(n,t),a.stepLength){const e=w(o,i).config;o=o.set("accuracy",e.accuracy).set("stepLength",e.stepLength)}this.props.onChange(o)},this.checkIfDatesInvalid=(e,t)=>{const{exactStartTime:a,exactEndTime:s}=this.props;let i=!0;const n=O(e,t);(t&&n>s||!t&&n<a)&&(i=!1),this.setState({isDateValid:i})},this.getOffsetUnits=e=>{let t;return t=e===s.dateUtils.VirtualDateType.Today?y:[...y,...S.filter((e=>"second"!==e))],t},this.onDateOffsetChanged=(e,t=!1)=>{const a=t?"startTime":"endTime",s=this.props.config.setIn([a,"offset"],e);this.checkIfDatesInvalid(s[a],t),this.props.onChange(s)},this.onAccuracyChanged=e=>{const{config:t,exactStartTime:a,exactEndTime:s,accuracyList:i}=this.props,n=e.target.value;let o=t.set("accuracy",n);if(t.stepLength&&i.indexOf(n)<i.indexOf(t.stepLength.unit)){const e=b(a,s,n);o=o.set("stepLength",e)}this.props.onChange(o)},this.onStepChecked=()=>{const{config:e,exactStartTime:t,exactEndTime:a}=this.props,s=b(t,a,e.accuracy);this.props.onChange(this.props.config.set("stepLength",s).set("dividedCount",null))},this.onDividedChecked=()=>{this.props.onChange(this.props.config.set("stepLength",null).set("dividedCount",5))},this.onStepLengthChanged=e=>{e.val=Math.round(e.val||1),this.props.onChange(this.props.config.set("stepLength",e).set("dividedCount",null))},this.onDividedCountChanged=e=>{e=e?Math.round(e):2,this.props.onChange(this.props.config.set("dividedCount",e).set("stepLength",null))},this.onSpeedChanged=e=>{const t=this.props.config.set("speed",e.target.value);this.props.onChange(t)},this.onChange=(e,t)=>{this.props.onChange(this.props.config.set(e,t))},this.getAllSupportedLayersFromMap=()=>{const{dataSources:e,dataSourceType:t,config:a}=this.props;return t===s.AllDataSourceTypes.WebMap?A(e,null==a?void 0:a.layerList):null},this.getSupportedLayerIdsFromMap=()=>{if(this.props.dataSourceType===s.AllDataSourceTypes.WebMap){const e=Object.keys(this.allSupportedLayers).map((e=>e));return(0,s.Immutable)(e)}return null},this.getSelectedDataSources=()=>{const{dataSources:e,dataSourceType:t,config:a}=this.props;let i={};return t===s.AllDataSourceTypes.WebMap?Object.keys(this.allSupportedLayers).forEach((e=>{(null===a.layerList||a.layerList.filter((t=>t.dataSourceId===e)).length>0)&&(i[e]=this.allSupportedLayers[e])})):i=e,i},this.getSelectedUseDataSources=()=>{var e;const{config:t,dataSourceType:a}=this.props;if(a===s.AllDataSourceTypes.WebMap){if(null!==t.layerList)return t.layerList;const a=[];return null===(e=Object.keys(this.allSupportedLayers))||void 0===e||e.forEach((e=>{var t,s;const i=this.allSupportedLayers[e];a.push({rootDataSourceId:null===(t=i.getRootDataSource())||void 0===t?void 0:t.id,dataSourceId:e,mainDataSourceId:null===(s=i.getMainDataSource())||void 0===s?void 0:s.id})})),(0,s.Immutable)(a)}return null},this.dataSourceChange=e=>{const t=w(null,A(this.props.dataSources,e)).config;this.props.onChange(t.set("layerList",e))},this.getDateValue=e=>e?("number"==typeof e&&(e=new Date(e)),e):null,this.isSelectionDisabled=()=>{const{layerList:e}=this.props.config;return null===e||e.length===this.state.supportedLayerIdsFromMap.length},this.getDsTimezone=()=>{const e=(0,s.getAppStore)().getState().appStateInBuilder.appConfig.attributes.timezone;return(null==e?void 0:e.type)===s.TimezoneConfig.Specific?e.value:null},this.allSupportedLayers=this.getAllSupportedLayersFromMap(),this.state={supportedLayerIdsFromMap:this.getSupportedLayerIdsFromMap(),selectedUseDataSources:this.getSelectedUseDataSources(),selectedDataSources:this.getSelectedDataSources(),isDateValid:e.exactStartTime<=e.exactEndTime}}componentDidUpdate(e,t){this.props.config.layerList!==e.config.layerList&&this.setState({selectedUseDataSources:this.getSelectedUseDataSources(),selectedDataSources:this.getSelectedDataSources()})}render(){const{i18nMessage:e,config:r,dataSourceType:g,intl:d,theme:m,exactStartTime:h,exactEndTime:D,accuracyList:y}=this.props,{supportedLayerIdsFromMap:S,selectedUseDataSources:M,selectedDataSources:f}=this.state,{startTime:T,endTime:v,accuracy:I,timeDisplayStrategy:w,stepLength:b,dividedCount:O,speed:C}=r,A="number"==typeof(null==T?void 0:T.value)?k(T.value,0,!0).startTime:null==T?void 0:T.value,z="number"==typeof(null==v?void 0:v.value)?k(0,v.value,!0).endTime:null==v?void 0:v.value,L=this.getDateValue(A),E=this.getDateValue(z),Q="string"==typeof(null==T?void 0:T.value)&&[s.dateUtils.VirtualDateType.Today,s.dateUtils.VirtualDateType.Now].includes(null==T?void 0:T.value),U="string"==typeof(null==v?void 0:v.value)&&[s.dateUtils.VirtualDateType.Today,s.dateUtils.VirtualDateType.Now].includes(null==v?void 0:v.value);return(0,s.jsx)("div",{className:"time-panel w-100 h-100",css:l(m)},g===s.AllDataSourceTypes.WebMap&&(0,s.jsx)(i.SettingSection,{className:"pt-0",title:(0,s.jsx)("span",{title:e("enableTimeAnimation")},e("enableTimeAnimation"))},(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(n.DataSourceSelector,{isMultiple:!0,"aria-label":e("enableTimeAnimation"),types:ie,useDataSources:M,mustUseDataSource:!0,disableDataView:!0,hideDataView:!0,closeDataSourceListOnChange:!0,disableRemove:()=>1===M.length,onChange:this.dataSourceChange,hideDs:e=>!S.includes(e.id),disableSelection:this.isSelectionDisabled})))),(0,s.jsx)(i.SettingSection,{role:"group",title:e("timeSpan"),"aria-label":e("timeSpan"),className:"border-0 "+(g!==s.AllDataSourceTypes.WebMap?"pt-0":"")},(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(H,{intl:d,theme:m,overalExtentLabel:e("overallTimeExtent"),dataSources:f,startTime:h,endTime:D,onChange:this.timeSpanChanged}))),(0,s.jsx)(i.SettingSection,{role:"group",title:e("startTime"),"aria-label":e("startTime"),className:"border-0 pt-0"},(0,s.jsx)(i.SettingRow,{className:"mt-2"},(0,s.jsx)(p.DatePicker,{style:{width:"226px"},"aria-label":e("startTime"),disablePortal:!1,selectedDate:L,format:"shortDateLongTime",runtime:!1,showDoneButton:!0,hideEmpty:!0,showTimeInput:!0,isTimeLong:!0,supportVirtualDateList:!0,virtualDateList:ne,dataSourceTimezone:this.getDsTimezone(),onChange:e=>{this.onTimeChanged(e,!0)}})),"string"==typeof(null==T?void 0:T.value)&&T.value===s.dateUtils.VirtualDateType.Min&&(0,s.jsx)(i.SettingRow,{className:"mt-1 date-label"},s.dateUtils.formatDateLocally(h,d,N,x)),Q&&(0,s.jsx)(i.SettingRow,{"aria-label":e("offset"),label:(0,s.jsx)("div",{title:e("offset"),css:c(73)},e("offset"))},(0,s.jsx)(u.DateUnitInput,{style:{width:"125px"},step:1,value:T.offset,units:this.getOffsetUnits(T.value),onChange:e=>{this.onDateOffsetChanged(e,!0)}}))),(0,s.jsx)(i.SettingSection,{role:"group",title:e("endTime"),"aria-label":e("endTime"),className:"border-0 pt-0"},(0,s.jsx)(i.SettingRow,{className:"mt-2"},(0,s.jsx)(p.DatePicker,{style:{width:"226px"},"aria-label":e("endTime"),disablePortal:!1,selectedDate:E,format:"shortDateLongTime",runtime:!1,showDoneButton:!0,hideEmpty:!0,showTimeInput:!0,isTimeLong:!0,supportVirtualDateList:!0,virtualDateList:oe,dataSourceTimezone:this.getDsTimezone(),onChange:e=>{this.onTimeChanged(e,!1)}})),"string"==typeof(null==v?void 0:v.value)&&v.value===s.dateUtils.VirtualDateType.Max&&(0,s.jsx)(i.SettingRow,{className:"mt-1 date-label"},s.dateUtils.formatDateLocally(D,d,N,x)),U&&(0,s.jsx)(i.SettingRow,{"aria-label":e("offset"),label:(0,s.jsx)("div",{title:e("offset"),css:c(73)},e("offset"))},(0,s.jsx)(u.DateUnitInput,{style:{width:"125px"},step:1,value:v.offset,units:this.getOffsetUnits(v.value),onChange:e=>{this.onDateOffsetChanged(e,!1)}})),!this.state.isDateValid&&(0,s.jsx)("div",{className:"d-flex mt-2 ml-1 mr-1",role:"alert","aria-live":"polite"},(0,s.jsx)(se,{color:this.props.theme.sys.color.error.dark,className:"mr-2"}),(0,s.jsx)("div",{className:"flex-grow-1",style:{color:m.sys.color.error.dark}},e("timeWarning")))),(0,s.jsx)(i.SettingSection,{className:"pt-0"},(0,s.jsx)(i.SettingRow,{flow:"wrap",label:(0,s.jsx)("div",{className:"m-0 d-flex justify-content-between"},(0,s.jsx)("span",null,e("setMinTimeAccuracy")),(0,s.jsx)(o.Tooltip,{title:e("setMinTimeAccuracyTip"),showArrow:!0,placement:"left"},(0,s.jsx)(o.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0"},(0,s.jsx)(X,null))))}),(0,s.jsx)(i.SettingRow,{className:"mt-1"},(0,s.jsx)(o.Select,{size:"sm",onChange:this.onAccuracyChanged,value:I},y.map((t=>(0,s.jsx)(o.Option,{key:t,value:t,active:t===I},e(t))))))),(0,s.jsx)(i.SettingSection,{role:"group",title:e("timeStep"),"aria-label":e("timeStep")},(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Label,{check:!0},(0,s.jsx)(o.Radio,{name:"time-step-radio",style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:!!b,onChange:this.onStepChecked}),e("lengthOfOneStep"))),b&&(0,s.jsx)(i.SettingRow,{className:"time-step-details"},(0,s.jsx)(u.DateUnitInput,{className:"w-100",min:1,step:1,value:b,units:y.filter((e=>j[e]>=j[I])),onChange:this.onStepLengthChanged})),(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Label,{check:!0},(0,s.jsx)(o.Radio,{name:"time-step-radio",style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:O>0,onChange:this.onDividedChecked}),e("totalTimeDividedIntoEqualSteps"))),O&&(0,s.jsx)(i.SettingRow,{className:"time-step-details",label:(0,s.jsx)("div",{title:e("count"),css:c(118)},e("count"))},(0,s.jsx)(o.NumericInput,{style:{width:"80px"},"aria-label":e("count"),size:"sm",min:2,showHandlers:!1,value:O,onAcceptValue:this.onDividedCountChanged}))),(0,s.jsx)(i.SettingSection,{role:"group",title:e("timeDisplay"),"aria-label":e("timeDisplay")},(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Tooltip,{placement:"bottom",title:e("showCurrentWindowTip"),describeChild:!0},(0,s.jsx)(o.Label,{check:!0},(0,s.jsx)(o.Radio,{name:"time-display-radio",style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:w===a.current,onChange:()=>{this.onChange("timeDisplayStrategy",a.current)}}),e("showCurrentWindow")))),(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Tooltip,{placement:"bottom",title:e("showDataCumulativelyTip"),describeChild:!0},(0,s.jsx)(o.Label,{check:!0},(0,s.jsx)(o.Radio,{name:"time-display-radio",style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:w===a.cumulatively,onChange:()=>{this.onChange("timeDisplayStrategy",a.cumulatively)}}),e("showDataCumulatively"))))),(0,s.jsx)(i.SettingSection,{title:e("defaultPlaySpeed")},(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Select,{size:"sm",onChange:this.onSpeedChanged,value:C,"aria-label":e("defaultPlaySpeed")},[t.Slowest,t.Slow,t.Medium,t.Fast,t.Fastest].map((t=>(0,s.jsx)(o.Option,{key:t,value:t,active:t===C},e(t.toLowerCase()))))))))}}var re=g(31027),ce=g.n(re),ue=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a};const pe=e=>{const t=window.SVG,{className:a}=e,i=ue(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:ce()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var ge=g(54337);class de extends s.React.PureComponent{constructor(){super(...arguments),this.onDataSourceCreated=e=>{this.props.onCreateDataSourceCreatedOrFailed(this.props.useDataSource.dataSourceId,e)},this.onCreateDataSourceFailed=()=>{this.props.onCreateDataSourceCreatedOrFailed(this.props.useDataSource.dataSourceId,null)}}render(){return(0,s.jsx)(s.DataSourceComponent,{useDataSource:this.props.useDataSource,onDataSourceCreated:this.onDataSourceCreated,onCreateDataSourceFailed:this.onCreateDataSourceFailed})}}var me=function(e,t,a,s){return new(a||(a=Promise))((function(i,n){function o(e){try{r(s.next(e))}catch(e){n(e)}}function l(e){try{r(s.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((s=s.apply(e,t||[])).next())}))};const he=Object.assign({},{selectDataSourceLabel:"One web map, multiple map services or feature layers",selectDataSourceTip:"You can choose either one web map, multiple map services or multiple feature layers for this widget. However, they must contain temporal data to be used. If the layers are not time-aware, they will not show in the select data panel.",timeSetting:"Time settings",honorTimeSettings:"Synchronize with the time settings in the web map",customTimeSettings:"Customize time settings",configureTime:"Configure time",classicStyle:"Classic",modernStyle:"Modern",displayOptions:"Display options",enableTimeAnimation:"Enable time animation for",timeSpan:"Time span",overallTimeExtent:"Overall time extent",startTime:"Start time",endTime:"End time",timeWarning:"The start time should be no later than the end time.",setMinTimeAccuracy:"Set the minimum time accuracy",setMinTimeAccuracyTip:"The minimum time accuracy represents the minimum time interval that users are allowed to see at runtime. If you set the time step based on defined length, you can move the slider by each minimum time accuracy.",timeDisplay:"Time display",showCurrentWindow:"Show current window",showCurrentWindowTip:"Only display data in the current time window.",showDataCumulatively:"Show data cumulatively",showDataCumulativelyTip:"Progressively display all data as time passes.",timeStep:"Time step",lengthOfOneStep:"Length of one step",totalTimeDividedIntoEqualSteps:"Total time divided into equal steps",defaultPlaySpeed:"Default play speed",timezoneWarning:"The Timeline widget is not available to use under the data time zone. Please change to the device or a specific time zone first."},o.defaultMessages),De=(0,s.Immutable)([s.AllDataSourceTypes.WebMap,s.AllDataSourceTypes.MapService,s.AllDataSourceTypes.FeatureLayer,s.AllDataSourceTypes.ImageryLayer,s.AllDataSourceTypes.ImageryTileLayer]);class ye extends s.React.PureComponent{constructor(e){super(e),this.i18nMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:he[e]},t),this.updateConfigForOptions=(e,t)=>{const a={id:this.props.id,config:this.props.config.set(e,t)};this.props.onSettingChange(a)},this.dataSourceChange=e=>me(this,void 0,void 0,(function*(){var t;let a=e,i=this.state.dataSources,n=this.props.config.set("timeSettings",null),o=n.dataSourceType;if(e.length<(null===(t=this.props.useDataSources)||void 0===t?void 0:t.length))delete i[this.props.useDataSources[this.props.useDataSources.length-1].dataSourceId],this.setState({dataSources:i}),0===a.length&&(n=n.set("honorTimeSettings",!0));else{const t=e[e.length-1],l=yield this.dsManager.createDataSourceByUseDataSource((0,s.Immutable)(t));let r=l.type===s.AllDataSourceTypes.WebMap&&n.honorTimeSettings;l.type===n.dataSourceType&&l.type!==s.AllDataSourceTypes.WebMap||(a=[t],o=l.type,i={},l.type!==n.dataSourceType&&l.type===s.AllDataSourceTypes.WebMap&&(r=!0)),i[t.dataSourceId]=l,this.setState({dataSources:i}),n=n.set("honorTimeSettings",r).set("dataSourceType",o)}this.props.onSettingChange({id:this.props.id,config:n,useDataSources:a})})),this.getTimeSettings=()=>w(this.props.config.timeSettings,this.state.dataSources),this.setHonorTimeSettings=()=>{const{id:e,config:t,onSettingChange:s}=this.props;if(t.honorTimeSettings){const i=function(e,t=!1){var s,i,n;let o=null;const l=e[Object.keys(e).filter((t=>e[t].type===D.ArcGISDataSourceTypes.WebMap))[0]],r=null===(n=null===(i=null===(s=null==l?void 0:l.getItemData())||void 0===s?void 0:s.widgets)||void 0===i?void 0:i.timeSlider)||void 0===n?void 0:n.properties;if(r){const{startTime:e,endTime:s,timeStopInterval:i,numberOfStops:n,thumbMovingRate:l,thumbCount:c}=r;let u=e,p=s;if(t){const t=k(e,s,!0);u=t.startTime,p=t.endTime}if(o={speed:I(l),layerList:null,startTime:{value:u},endTime:{value:p},timeDisplayStrategy:2===c?a.current:a.cumulatively},i){const e=function(e){switch(e){case"esriTimeUnitsMonths":return"month";case"esriTimeUnitsDays":return"day";case"esriTimeUnitsHours":return"hour";case"esriTimeUnitsMinutes":return"minute";default:return"year"}}(i.units);o.accuracy=e,o.stepLength={val:i.interval,unit:e}}else if(n){o.dividedCount=n;const e=z(u,p);o.accuracy=e[0];const t=(p-u)/n;e.some((e=>t>=1e3*j[e]&&(o.accuracy=e,!0)))}}return o}(this.state.dataSources);s({id:e,config:t.set("honorTimeSettings",!1).set("timeSettings",i)})}else s({id:e,config:t.set("honorTimeSettings",!0).set("timeSettings",null)})},this.enablePlayControl=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("enablePlayControl",t).set("autoPlay",!1)})},this.onTimeSettingPanel=()=>{this.setState({isTimePanelOpen:!this.state.isTimePanelOpen})},this.onCreateDataSourceCreatedOrFailed=(e,t)=>{this.setState((a=>{const s=Object.assign({},a.dataSources);return s[e]=t,{dataSources:s}}))},this.isTimeExtentValid=()=>{let e=!1;return Object.keys(this.state.dataSources).some((t=>{var a;const i=this.state.dataSources[t];if(i.type===s.AllDataSourceTypes.FeatureLayer){const t=null===(a=i.getTimeInfo())||void 0===a?void 0:a.timeExtent;if((null==t?void 0:t[0])&&(null==t?void 0:t[1])&&t[0]===t[1])return e=!0,!0}return!1})),e},this.hideDs=e=>{var t;let a=!1;const i=null===(t=this.dsManager)||void 0===t?void 0:t.getDataSource(e.id);if(L(i.type))a=!i.supportTime()||null!==s.dataSourceUtils.findMapServiceDataSource(i);else if(i.type===s.AllDataSourceTypes.WebMap){a=0===i.getAllChildDataSources().filter((e=>(L(e.type)||e.type===s.AllDataSourceTypes.MapService)&&e.supportTime())).length}else a=!i.supportTime();return a},this.dsManager=s.DataSourceManager.getInstance(),this.state={isTimePanelOpen:!1,dataSources:{}}}componentDidUpdate(e,t){this.props.config.honorTimeSettings!==e.config.honorTimeSettings&&this.props.config.honorTimeSettings&&this.setState({isTimePanelOpen:!1})}render(){const{theme:t,theme2:a,config:l,useDataSources:c,intl:u,isTimeZoneData:p}=this.props,{honorTimeSettings:d,timeStyle:m,backgroundColor:h,foregroundColor:D,sliderColor:y,enablePlayControl:S,autoPlay:M,dataSourceType:f}=l,T=(null==c?void 0:c.length)>0;return(0,s.jsx)("div",{className:(0,s.classNames)("jimu-widget-setting widget-setting-timeline",{"show-disabled-mask":p}),css:r(t)},null==c?void 0:c.map(((e,t)=>(0,s.jsx)(de,{key:t,useDataSource:e,onCreateDataSourceCreatedOrFailed:this.onCreateDataSourceCreatedOrFailed}))),(0,s.jsx)(i.SettingSection,{role:"group",className:T?"":"border-0",title:this.i18nMessage("source"),"aria-label":this.i18nMessage("source")},(0,s.jsx)(i.SettingRow,{flow:"wrap",className:"mt-2",label:(0,s.jsx)("div",{className:"m-0 d-flex justify-content-between"},(0,s.jsx)("span",{id:"timeline-ds-label"},this.i18nMessage("selectDataSourceLabel")),(0,s.jsx)(o.Tooltip,{title:this.i18nMessage("selectDataSourceTip"),showArrow:!0,placement:"left"},(0,s.jsx)(o.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0"},(0,s.jsx)(X,null))))}),(0,s.jsx)(i.SettingRow,{className:"mt-2"},(0,s.jsx)(n.DataSourceSelector,{hideAllOptionOfTypeDropdown:!0,isMultiple:!0,"aria-describedby":"timeline-ds-label timeline-blank-msg",types:De,useDataSources:c||(0,s.Immutable)([]),mustUseDataSource:!0,disableDataView:!0,hideDataView:!0,hideDs:this.hideDs,closeDataSourceListOnChange:!1,onChange:this.dataSourceChange}))),T?(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(i.SettingSection,{role:"group",title:this.i18nMessage("timeSetting"),"aria-label":this.i18nMessage("timeSetting")},f===s.AllDataSourceTypes.WebMap&&(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Label,{className:"honor-label",check:!0},(0,s.jsx)(o.Radio,{name:"time-setting-radio",style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:d,onChange:this.setHonorTimeSettings}),this.i18nMessage("honorTimeSettings"))),(0,s.jsx)(i.SettingRow,{className:"mt-2"},(0,s.jsx)(o.Label,{className:"honor-label",check:!0},f===s.AllDataSourceTypes.WebMap&&(0,s.jsx)(o.Radio,{name:"time-setting-radio",style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:!d,onChange:this.setHonorTimeSettings}),this.i18nMessage("customTimeSettings"))),(!d||f===s.AllDataSourceTypes.FeatureLayer)&&(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(i.SettingRow,{className:"mt-4"},(0,s.jsx)(o.Button,{className:"w-100",ref:e=>{this.timeSettingsRef=e},onClick:this.onTimeSettingPanel,disabled:0===Object.keys(this.state.dataSources).length||this.isTimeExtentValid()},(0,s.jsx)("div",{className:"w-100 px-2 text-truncate"},this.i18nMessage("configureTime")))),(0,s.jsx)(i.SettingRow,null,this.isTimeExtentValid()&&(0,s.jsx)(o.Alert,{open:!0,type:"warning",tabIndex:0,className:"w-100",text:"The time extent is not ready. Cannot configure time settings at this time."})))),(0,s.jsx)(i.SettingSection,{role:"group",title:this.i18nMessage("style"),"aria-label":this.i18nMessage("style")},(0,s.jsx)(i.SettingRow,{className:"style-container"},[e.Classic,e.Modern].map(((e,t)=>{const a=e.toLowerCase();return(0,s.jsx)(o.Tooltip,{key:t,title:this.i18nMessage(`${a}Style`),placement:"bottom"},(0,s.jsx)(o.Button,{icon:!0,size:"sm",type:"tertiary",active:e===m,"aria-pressed":e===m,onClick:()=>{this.updateConfigForOptions("timeStyle",e)}},(0,s.jsx)(o.Icon,{width:104,height:70,icon:g(15656)(`./style_${a}.svg`)})))})))),(0,s.jsx)(i.SettingSection,{role:"group",title:this.i18nMessage("appearance"),"aria-label":this.i18nMessage("appearance")},(0,s.jsx)(i.SettingRow,{label:this.i18nMessage("foregroundColor")},(0,s.jsx)(ge.ThemeColorPicker,{"aria-label":this.i18nMessage("foregroundColor"),specificTheme:a,value:D,onChange:e=>{this.updateConfigForOptions("foregroundColor",e)}})),(0,s.jsx)(i.SettingRow,{label:this.i18nMessage("backgroundColor")},(0,s.jsx)(ge.ThemeColorPicker,{"aria-label":this.i18nMessage("backgroundColor"),specificTheme:a,value:h,onChange:e=>{this.updateConfigForOptions("backgroundColor",e)}})),(0,s.jsx)(i.SettingRow,{label:this.i18nMessage("sliderColor")},(0,s.jsx)(ge.ThemeColorPicker,{"aria-label":this.i18nMessage("sliderColor"),specificTheme:a,value:y,onChange:e=>{this.updateConfigForOptions("sliderColor",e)}}))),(0,s.jsx)(i.SettingSection,{role:"group",title:this.i18nMessage("displayOptions"),"aria-label":this.i18nMessage("displayOptions")},(0,s.jsx)(i.SettingRow,{label:this.i18nMessage("enablePlayControl")},(0,s.jsx)(o.Switch,{checked:S,onChange:this.enablePlayControl,"aria-label":this.i18nMessage("enablePlayControl")})),S&&(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Label,{className:"w-100 d-flex"},(0,s.jsx)(o.Checkbox,{style:{cursor:"pointer",marginTop:"2px"},checked:M,onChange:()=>{this.updateConfigForOptions("autoPlay",!M)}}),(0,s.jsx)("div",{className:"m-0 ml-2 flex-grow-1 autoplay-label"},this.i18nMessage("autoPlay"))))),!d&&(0,s.jsx)(i.SidePopper,{position:"right",title:this.i18nMessage("configureTime"),isOpen:this.state.isTimePanelOpen,trigger:this.timeSettingsRef,toggle:this.onTimeSettingPanel},Object.keys(this.state.dataSources).length===c.length&&(0,s.jsx)(le,Object.assign({intl:u,theme:t,i18nMessage:this.i18nMessage,dataSources:this.state.dataSources,dataSourceType:f},this.getTimeSettings(),{onChange:e=>{this.updateConfigForOptions("timeSettings",e)}})))):(0,s.jsx)("div",{className:"empty-placeholder w-100"},(0,s.jsx)("div",{className:"empty-placeholder-inner"},(0,s.jsx)("div",{className:"empty-placeholder-icon"},(0,s.jsx)(pe,{size:48})),(0,s.jsx)("div",{className:"empty-placeholder-text",id:"timeline-blank-msg"},this.i18nMessage("selectDataPlaceholder")))),p&&(0,s.jsx)("div",{className:"disabled-mask w-100 h-100"},(0,s.jsx)("div",{className:"mask-bg"}),(0,s.jsx)(o.Alert,{form:"basic",type:"warning",className:"alert-container"},this.i18nMessage("timezoneWarning"))))}}const Se=s.ReactRedux.connect(((e,t)=>{var a,i;return{isTimeZoneData:(null===(i=null===(a=e.appStateInBuilder.appConfig.attributes)||void 0===a?void 0:a.timezone)||void 0===i?void 0:i.type)===s.TimezoneConfig.Data}}))(ye);function Me(e){g.p=e}})(),d})())}}}));