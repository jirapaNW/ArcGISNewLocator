System.register(["jimu-core","widgets/shared-code/lrs"],(function(e,t){var r={},o={};return{setters:[function(e){r.AbstractDataAction=e.AbstractDataAction,r.DataLevel=e.DataLevel,r.DataSourceStatus=e.DataSourceStatus,r.DataSourceTypes=e.DataSourceTypes,r.Immutable=e.Immutable,r.MutableStoreManager=e.MutableStoreManager,r.getAppStore=e.getAppStore},function(e){o.LrsLayerType=e.LrsLayerType,o.isDefined=e.isDefined}],execute:function(){e((()=>{"use strict";var e={79244:e=>{e.exports=r},47626:e=>{e.exports=o}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,a),n.exports}a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{a.r(n),a.d(n,{default:()=>o});var e=a(79244),t=a(47626),r=function(e,t,r,o){return new(r||(r=Promise))((function(a,n){function i(e){try{s(o.next(e))}catch(e){n(e)}}function u(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,u)}s((o=o.apply(e,t||[])).next())}))};class o extends e.AbstractDataAction{isSupported(o,a){return r(this,void 0,void 0,(function*(){var r;if(o.length>1)return!1;const n=o[0];if(n.records.length<2)return!1;const{dataSource:u,records:s}=n,d=u.type===e.DataSourceTypes.FeatureLayer||u.type===e.DataSourceTypes.SceneLayer,c=u.isDataSourceSet,l=a!==e.DataLevel.Records,p=n.dataSource,f=(null==p?void 0:p.supportSpatialInfo)&&(null==p?void 0:p.supportSpatialInfo()),v=a===e.DataLevel.Records&&0===(null==s?void 0:s.length),S=!u.isInAppConfig()&&!d;if(c||l||v||S||!f)return!1;if(!u||u.getStatus()===e.DataSourceStatus.NotReady)return!1;const y=u;if(!(0,t.isDefined)(y))return!1;const g=i();let D;return(null===(r=null==g?void 0:g.widgets)||void 0===r?void 0:r[this.widgetId]).config.lrsLayers.forEach((e=>{e.id===y.id&&(D=e)})),!(!(0,t.isDefined)(D)||D.layerType!==t.LrsLayerType.event)}))}onExecute(t,o){return r(this,void 0,void 0,(function*(){var r;const o=t[0].dataSource,a=i();let n;return(null===(r=null==a?void 0:a.widgets)||void 0===r?void 0:r[this.widgetId]).config.lrsLayers.forEach((e=>{e.id===o.id&&(n=e)})),setTimeout((()=>{e.MutableStoreManager.getInstance().updateStateValue(this.widgetId,"selectedEventLyr",(0,e.Immutable)(n))}),1e3),!0}))}}function i(){var t,r,o;return window.jimuConfig.isBuilder?null===(r=null===(t=(0,e.getAppStore)().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===r?void 0:r.appConfig:null===(o=(0,e.getAppStore)().getState())||void 0===o?void 0:o.appConfig}})(),n})())}}}));