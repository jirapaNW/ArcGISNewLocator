define(["exports","./index-4ba3e564","./index2-929c934e","./utils-170619d9","./analysis-tree2-f394ec74","./isObject-a5254a4d","./isSymbol-63ae5f3a"],(function(e,t,i,s,a,r,n){"use strict";var l=/\s/,o=/^\s+/;var c=NaN,h=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,f=/^0o[0-7]+$/i,d=parseInt;function p(e){if("number"==typeof e)return e;if(n.isSymbol(e))return c;if(r.isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r.isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;var i;e=(i=e)?i.slice(0,function(e){for(var t=e.length;t--&&l.test(e.charAt(t)););return t}(i)+1).replace(o,""):i;var s=u.test(e);return s||f.test(e)?d(e.slice(2),s?2:8):h.test(e)?c:+e}const v=function(){return r.root$1.Date.now()};var m=Math.max,g=Math.min;const y=t.proxyCustomElement(class extends t.H{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.analysisSpatialReferenceValueChange=t.createEvent(this,"analysisSpatialReferenceValueChange",7),this.analysisSpatialReferenceSelectorDismissed=t.createEvent(this,"analysisSpatialReferenceSelectorDismissed",7),this.searchText="",this.performantFilterSpatialReferences=function(e,t,i){var s,a,n,l,o,c,h=0,u=!1,f=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var i=s,r=a;return s=a=void 0,h=t,l=e.apply(r,i)}function S(e){var i=e-c;return void 0===c||i>=t||i<0||f&&e-h>=n}function b(){var e=v();if(S(e))return R(e);o=setTimeout(b,function(e){var i=t-(e-c);return f?g(i,n-(e-h)):i}(e))}function R(e){return o=void 0,d&&s?y(e):(s=a=void 0,l)}function C(){var e=v(),i=S(e);if(s=arguments,a=this,c=e,i){if(void 0===o)return function(e){return h=e,o=setTimeout(b,t),u?y(e):l}(c);if(f)return clearTimeout(o),o=setTimeout(b,t),y(c)}return void 0===o&&(o=setTimeout(b,t)),l}return t=p(t)||0,r.isObject(i)&&(u=!!i.leading,n=(f="maxWait"in i)?m(p(i.maxWait)||0,t):n,d="trailing"in i?!!i.trailing:d),C.cancel=function(){void 0!==o&&clearTimeout(o),h=0,s=c=a=o=void 0},C.flush=function(){return void 0===o?l:R(v())},C}((e=>{this.updateSearchResults(e)}),250,{leading:!1,trailing:!0}),this.autoFilterToDefault=!1,this.defaultWkid=4326,this.value=void 0,this.hideCategories=void 0,this.hideDone=!1,this.searchResults=void 0}onAutoFilterToDefaultChange(){this.autoFilterSpatialReferences()}onDefaultWkidChange(){this.autoFilterSpatialReferences()}async getSRDescription(){return void 0!==this.value?.latestWkid?Promise.resolve(i.getSpatialReferenceDescription(this.value?.latestWkid)):Promise.resolve(void 0)}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await i.fetchComponentLocaleStrings(this.hostElement,t.getAssetPath("."))),this.value=this.value??{latestWkid:this.defaultWkid};const e=this.filterSrCategories(i.srCategories);this.visibleSrCategories=this.translateSrCategories(e)}componentDidLoad(){this.autoFilterSpatialReferences()}translateSrCategories(e){const t={};return this.recursiveTranslate(e,t),t}recursiveTranslate(e,t){Object.keys(e).forEach((i=>{const s=this.getTranslatedKey(i);"object"==typeof e[i]?(t[s]={},this.recursiveTranslate(e[i],t[s])):t[s]=e[i]}))}getTranslatedKey(e){return e in this.strings?this.strings[e]:e}filterSrCategories(e){const t={};return Object.keys(e).forEach((i=>{void 0!==this.hideCategories&&!1!==this.hideCategories?.includes(i)||("object"==typeof e[i]?t[i]=this.filterSrCategories(e[i]):t[i]=e[i])})),t}setSpatialRef(e){this.value={latestWkid:Number(e)},this.analysisSpatialReferenceValueChange.emit(this.value)}inputKeyDown(e){"Enter"===e.key&&this.selectFirstChild(!0)}selectFirstChild(e){const t=this.treeElement,i=t?.shadowRoot?.querySelector("calcite-tree-item:not([has-children]):not([data-key='placeholder'])")||void 0;void 0!==t&&void 0!==i&&(i.selected=!0,this.setSpatialRef(i.dataset.key??""),e&&i.focus())}updateSearchResults(e){this.searchResults=i.filterSpatialReferences(e)}searchSpatialReferences(e){null!==e.target&&this.setSearchText(e.target.value??"")}setSearchText(e){this.searchText=e,this.searchText.length>1?this.performantFilterSpatialReferences(this.searchText):this.searchResults=void 0}autoFilterSpatialReferences(){this.autoFilterToDefault&&!1===i.isEmptyDataItem(this.defaultWkid)&&void 0!==this.searchInput&&(this.searchInput.value=this.defaultWkid.toString(),this.setSearchText(this.searchInput.value))}render(){const e=i.formatMessage(this.strings.noMatchesFound,{searchTerm:this.searchText??""});return t.h(t.Host,{key:"07ab1df7f2a359622d9fdddbe5127be1fdccc157",dir:this.dir},t.h("calcite-panel",{key:"973bfc35f652db5f4acba117909e3e7a46a46623",closable:!1,closed:!1,onCalcitePanelClose:()=>this.analysisSpatialReferenceSelectorDismissed.emit(this.value)},t.h("calcite-input",{key:"bb7bb43fcd9f25a79498157f38208d606a502b91",onCalciteInputInput:e=>this.searchSpatialReferences(e),onKeyDown:e=>this.inputKeyDown(e),placeholder:this.strings.searchPlaceholder,scale:s.UIDefaults.Scale,type:"search",icon:!0,autofocus:!0,ref:e=>this.searchInput=e}),this.searchText.length>1&&i.isEmptyDataItem(this.searchResults)&&t.h("p",{key:"75ced46e4c23b438989a48ffa7b3cc0d9f8bc7ba",class:"no-matches-found-msg"},e),t.h("analysis-tree",{key:"tree",ref:e=>this.treeElement=e,data:void 0!==this.searchResults&&this.searchText.length>0?this.searchResults:this.visibleSrCategories,value:this.value&&`${this.value?.latestWkid}`,onAnalysisTreeValueChange:()=>{this.setSpatialRef(this.treeElement.value)}}),this.hideDone?void 0:t.h("calcite-button",{appearance:"solid",scale:s.UIDefaults.Scale,width:"full",slot:"footer-actions",onClick:()=>this.analysisSpatialReferenceSelectorDismissed.emit(this.value)},this.strings.done)))}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get watchers(){return{autoFilterToDefault:["onAutoFilterToDefaultChange"],defaultWkid:["onDefaultWkidChange"]}}static get style(){return":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:#d4d4d4;--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh}:host{overflow-y:hidden;display:flex;flex-direction:column;--calcite-color-border-input:var(--analysis-ui-border-input);height:var(--analysis-popover-content-height);min-width:20rem;max-width:27rem}.no-matches-found-msg{margin:var(--analysis-half-spacing);font-size:var(--calcite-font-size--2)}analysis-tree{flex:1}"}},[1,"analysis-spatial-reference-selector",{autoFilterToDefault:[4,"auto-filter-to-default"],defaultWkid:[514,"default-wkid"],value:[1040],hideCategories:[16],hideDone:[4,"hide-done"],searchResults:[32],getSRDescription:[64]},void 0,{autoFilterToDefault:["onAutoFilterToDefaultChange"],defaultWkid:["onDefaultWkidChange"]}]);function S(){"undefined"!=typeof customElements&&["analysis-spatial-reference-selector","analysis-tree"].forEach((e=>{switch(e){case"analysis-spatial-reference-selector":customElements.get(e)||customElements.define(e,y);break;case"analysis-tree":customElements.get(e)||a.defineCustomElement()}}))}S(),e.AnalysisSpatialReferenceSelector=y,e.defineCustomElement=S}));